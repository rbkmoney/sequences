[
    {sequences, [
        {automaton_service_url, <<"http://machinegun:8022/v1/automaton">>},
        {ip, "::"},
        {port, 8022},
        {transport_opts, #{
            % same as ranch defaults
            max_connections => 1024
        }},
        {protocol_opts, #{
            % Keepalive timeout
            request_timeout => 6000,
            % Should be greater than any other timeouts
            idle_timeout => infinity
        }},
        {shutdown_timeout, 7000},
        {health_checkers, [
            {erl_health, disk     , ["/", 99]        },
            {erl_health, cg_memory, [99]             },
            {erl_health, service  , [<<"sequences">>]}
        ]}
    ]},
    {lager, [
        {error_logger_redirect, true},
        {log_root, "/var/log/sequences"},
        {handlers, [
            {lager_file_backend, [
                {file, "log.json"},
                {level, debug},
                {formatter, lager_logstash_formatter}
            ]}
        ]}
    ]},
    {scoper, [
        {storage, scoper_storage_lager}
    ]}
].
